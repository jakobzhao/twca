<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Geovisual Analytic Platform for TWCA">
  <meta name="author" content="Bo Zhao, Benji Antolin, Fengyu Xu">
  <title>Water Calculator</title>
  <!-- css stylesheets -->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/leaflet.css" />
  <link rel="stylesheet" href="css/fontawesome.css">
  <link rel="stylesheet" href="css/google-fonts.css" />
  <link href="css/c3.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/Control.Geocoder.css" />
  <link rel="stylesheet" href="css/simplebar.css" />

  <link rel="stylesheet" href="css/main.css">
  <link rel="icon" href="img/favicon.ico" type="image/x-icon" />

  <!-- javascript libraries -->
  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/d3.js"></script>
  <script src="js/topojson.v1.min.js"></script>
  <script src="js/c3.min.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script> -->
  <script src="js/bootstrap.min.js"></script>
  <script src="js/simplebar.min.js"></script>
  <script src="js/leaflet.js"></script>
  <script src="js/Control.Geocoder.js"></script>
  <script src="js/leaflet-pip.js"></script>



  <script src="js/L.TopoJSON.js"></script>
  <script src="js/geotiff.js"></script>
  <script src="js/plotty.js"></script>
  <script src="js/leaflet-geotiff.js"></script>
  <script src="js/chroma.min.js"></script>
</head>

<body>
  <main>
    <div class="loader"></div>
    <!-- Water calculator inputs -->
    <div id="info" data-simplebar data-simplebar-auto-hide="false">
      <div id="title"><i class="fas fa-tachometer-alt"></i> Irrigation Calculator
        <span><a href="https://www.facebook.com/TurfgrassWaterConservationAlliance/" target="_blank"><i class="fab fa-facebook"></i></a></span>
        <span><a href="https://twitter.com/_tgwca" target="_blank"><i class="fab fa-twitter-square"></i></a></span>
        <span><a data-toggle="modal" data-target="#disclaimer"><i class="nav fas fa-question-circle"></i></a></span>
      </div>
      <p style="font-size:small; font-style:italic"> Please work through the order of the following steps to calculate the water for irrigation.</p>
      <div class="step">
        <p>Step 1: How green do you want your lawn to be?</p>
        <div role="group">
          <button type="button" class="btn">
            <img src="img/SNAP_0.4ET.bmp" class="img-thumbnail" alt="survival">
            <p>Survival</p>
          </button>
          <button type="button" class="btn" style="background-color:#777">
            <img src="img/SNAP_0.5ET.bmp" class="img-thumbnail" alt="adequate">
            <p>Adequate</p>
          </button>
          <button type="button" class="btn">
            <img src="img/SNAP_0.6ET.bmp" class="img-thumbnail" alt="homeowner">
            <p>Homeowner</p>
          </button>
          <button type="button" class="btn">
            <img src="img/SNAP_0.8ET.bmp" class="img-thumbnail" alt="premium">
            <p>Premium</p>
          </button>
          <button type="button" class="btn">
            <img src="img/SNAP_1.0_ET.bmp" class="img-thumbnail" alt="professional">
            <p>Professional</p>
          </button>
        </div>
      </div>
      <div class="step">
        <p>Step 2: How much water does your irrigation system put out (in/hr)?<input id="waterhr" type="number" name="runtime" min="0" value="0.6"></p>
        <p id="runtime">
          <small><i><a data-toggle="modal" data-target="#pr-modal">How to determine my preciptitation rate? <i class="pr fas fa-info-circle"></i></a></i></small>
        </p>
      </div>

      <div class="step">
        <p>Step 3: How many times per week do you run your irrigation system?
          <span>
            <select id="run" class="custom-select custom-select-sm">
              <option value="1">1 time</option>
              <option value="2">2 times</option>
              <option value="3" selected="selected">3 times</option>
              <option value="4">4 times</option>
              <option value="5">5 times</option>
            </select></span>
        </p>
      </div>
      <div class="step">
        <p>Step 4: Is your turf TCWA qualified?<small><i><a data-toggle="modal" data-target="#twcaModal">&nbsp;<i class="pr fas fa-info-circle"></i></a></i></small>
          <span>
            <select id="spf" class="custom-select custom-select-sm">
              // change the value to 1.1 from 1
              <option value="1.1">Yes</option>
              <option value="2" selected="selected">No</option>
            </select>
          </span>
        </p>
      </div>
      <div class="step">
        <p>Step 5: What month are you irrigating?
          <span>
            <select id="rainVolume" class="custom-select custom-select-sm">
              <option value="1">January</option>
              <option value="2">February</option>
              <option value="3">March</option>
              <option value="4">April</option>
              <option value="5">May</option>
              <option value="6">June</option>
              <option value="7">July</option>
              <option value="8">August</option>
              <option value="9">September</option>
              <option value="10">October</option>
              <option value="11">November</option>
              <option value="12">December</option>
            </select>
          </span>
        </p>

      </div>
      <div class="step">
        <p>Step 6: Select a location on the map via clicking on the map or entering a location on the search box on the top right corner. This version only supports locations in the contigious United States (Alaska, Hawaii are excluded.)
          <small><a data-toggle="modal" data-target="#soilModal" style="color:red"> The result will be shown after a location is picked on the map.
            <i class="pr fas fa-info-circle" style="color:white"></i></a></small></p>
      </div>
      <hr>
      <div class="result">
        <p class="d-flex justify-content-center">Minutes Per Irrigation&nbsp;<span id="soiltype"><span>
        <div id="waterGauge" style="min-height: 150px"></div>
      </div>

      <div class="step">
        <p>
          <span><a href="https://www.tgwca.org/" target="_blank"><img width="60" height="60" src="img\logoonwhite.png" id="twcaLogo" alt="twcaLogo"></a></span>
          <span><a href="https://turfmerchants.com" target="_blank"><img height="60" src="img\TMI-logo-New2015TRN.png"></a></span>
        </p>
        <span><a href="https://www.pennington.com/all-products/grass-seed" target="_blank"><img src="img\pennington-logo-(minus-glow)TRN.png" id="penningtonLogo" class="logo-thumbnail" alt="penningtonLogo"></a></span>
        <span><a href="http://proseedsmarketing.com/" target="_blank"><img src="img\proseeds_finalTRN.png" id="proseedsLogo" class="logo-thumbnail" alt="proseedsLogo"></a></span>
        <span><a href="https://www.pureseed.com/" target="_blank"><img src="img\Pure_seedTRN.png" id="pureseedLogo" class="logo-thumbnail" alt="pureseedLogo"></a></span>
      </div>
      <p style="font-size: 10pt">Supported by <a href="http://hgis.uw.edu">Humanistic GIS Lab at University of Washington - Seattle</a>, <a href="https://ceoas.oregonstate.edu/" target="_blank">College of Earth, Ocean, and Atmospheric Sciences at
          Oregon State University </a> and <a href="https://division.uaex.edu/" target="_blank">the division of agriculture, University of Arkansas</a>.</p>
    </div>

    <div id="map" role="main" class="container-fluid"></div>
  </main>
  <!--disclaimer Modal -->
  <div id="disclaimer" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document" style="width:1250px!important">
      <div class="modal-content">
        <div class="modal-header">
          <strong class="modal-title" id="exampleModalLongTitle">Disclaimer</strong>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="demo" class="carousel slide" data-ride="carousel">
            <p>This calculator is intended only as a watering guide and is based on historical data. For greater accuracy we recommend consulting with your local extension agency. Please make sure your watering practice complies with state and local
              ordinances. For more information about this calculator contact us at <a href="mailto://info@tgwca.org">info@tgwca.org</a>.</p>
          </div>
        </div>
        <div class="modal-footer">
          <div class="col-md-10">
            <span id="mapType">Don't show this info again.</span>
            <label id="nextTimeSwitcher" class="switch">
              <input type="checkbox">
            </label>
          </div>
          <button id="disclaimer-close" type="button" class="btn btn-primary col-md-2">close</button>
        </div>
      </div>
    </div>
  </div>
  <!-- soil modal -->
  <div id="soilModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document" style="width:1250px!important">
      <div class="modal-content">
        <div class="modal-header">
          <strong class="modal-title" id="exampleModalLongTitle">
            <h5>What impact does soil have on my water need?</h5>
          </strong>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="demo" class="carousel slide" data-ride="carousel">
            <p>While soil texture doesn’t impact water demand it does affect recommended watering frequency. Sandy soils require more frequent watering with shorter run times. If you’re unsure about your soil type check with your local extension
              agent.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- TWCA Qalified modal -->
  <div id="twcaModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document" style="width:1250px!important">
      <div class="modal-content">
        <div class="modal-header">
          <strong class="modal-title" id="exampleModalLongTitle">
            <h5>How do I know if my turf is TWCA Qualified?</h5>
          </strong>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="demo" class="carousel slide" data-ride="carousel">
            <p>All TWCA qualified cultivars carry the TWCA seal. You can learn more about the TWCA Qualified cultivars at <a href="https://www.tgwca.org/list-of-qualified-products1.html">https://www.tgwca.org/list-of-qualified-products1.html</a>. If
              you’re unsure it is best to assume your turf is not TWCA Qualified.</p>
          </div>
        </div>
        <div id="twcaFooter" class="col-xs-10">
          <div class="modal-footer" style="float: left;">
            For more information contact us at &nbsp <a href="mailto://info@tgwca.org">info@tgwca.org</a>.
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--the info page-->
  <div class="modal fade" id="pr-modal" role="dialog">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Determining Precipitation Rates of Your Irrigation System</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          <p>This fairly simple step is crucial to maximizing the accuracy and effectiveness of the Water Star&reg; Irrigation Calculation.&nbsp; <br><br>
            You have <b><u>two</u></b> options for determining the irrigation rate:</p>
          <hr class="black">
          <strong><b>Option 1) Direct Measurement</b></strong><br>
          <strong>To perform Direct Measurement you&rsquo;ll need:</strong> <br>
          <ol>
            <li><b>Stopwatch</b> - to time the sprinkler runtime</li><br />
            <li><b>Catchcan(s)</b> -&nbsp; simple non-tapered containers are commercially available in a number of different retail locations,
              but any straight sided container will do.</li><br />
            <li><b>Ruler</b> &ndash; for measuring the depth of water in each catchcan.</li><br /><br />
            <li><b>Pen and notepad</b> &ndash; for recording the depth of water in each catchcan.</li><br />
            <li><b>Calculator</b>- for doing some calculations with the data that you gather.</li><br />
          </ol>
          <p>Very simple, the Direct Measurement approach can be performed with a single catchcan or with multiple catchcans in the same zone
            at the same time.&nbsp; Using multiple catchcans in the same hydrozone and averaging out the results gives a better overall view
            of the precipitation rate.&nbsp; <br><br>

            <b><i>These instructions will be given assuming you are using <u>multiple</u> cans in each hydrozone.&nbsp;</i></b>
          </p>
          <p><b>First</b>, place your cans throughout the hydrozone being tested.&nbsp; **Make sure the sprinklers reach the cans.&nbsp; Make sure the cans are empty.**</p>
          <p><b>Next</b>, turn on your sprinkler and run it for 10 minutes.&nbsp; **Make sure you are timing the entire run time.**</p>
          <p>Writing down the volumes from each catchcan makes doing the final calculations a breeze.</p>
          <p>The calculations follow the equation:</p>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <strong>PR= (AW/time)*(60min./1hr)</strong>&nbsp;
          <p>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PR = Precipitation Rate<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AW = Applied Water</p>
          <p><b>**Note: If using multiple catchcans the calculation for Applied Water is:**</b></p>
          <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <b>AW=(AW<sub>1 </sub>&nbsp;+ AW<sub>2</sub> +&hellip;+ AW<sub>n</sub>)/n </b></p>
          <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
            n = the number of catchcans used in the hydrozone being tested.
            &nbsp;&nbsp; &nbsp;&nbsp;
          </p>

          <p><b>Now</b>, enter the value you&rsquo;ve calculated into the Precipitation Rate space in the Calculator tool.</p>
          <hr class="black">
          <strong><b>Option 2)&nbsp; Total Area Method</b></strong>
          <p><strong>To apply the Total Area method you&rsquo;ll need:</strong></p>
          <ol>
            <li><b>Measuring tape and two stakes</b> - for measuring the perimeter of the irrigated area</li><br />
            <li><b>Pen and notepad</b> -&nbsp; for writing down your calculations before making them with the calculator</li><br />
            <li><b>Manufacturer Performance Charts</b> &ndash; this will give the application rate of each individual sprinkler head in the hydrozone being tested</li><br /><br />
          </ol>

          <p>Use the measuring tape and stakes to measure the edges of the hydrozone being inspected.&nbsp; <br>
            Use these measurements to calculate the area of the hydrozone and write it in your notes as A=(your calculated area)sqft.&nbsp;</p>
          <p><b>After</b> measuring the edges of your hydrozone, count the number of sprinklers in the hydrozone.&nbsp; Write this number in your notes as &ldquo;n=(the number of sprinkler heads in your area of interest)</p>
          <p><b>Next</b>, use the Manufacturer Performance Charts to reference the application rate of each sprinkler head.&nbsp;&nbsp; Multiply this number times &ldquo;n&rdquo;, the number of sprinkler heads you counted in your area of
            interest.&nbsp; Write this value down as GPM= (n x gallons per minute per sprinkler head)</p>
          <p><b>Finally</b>, use this equation:</p>
          <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <strong>PR = (96.25*GPM)/A </strong> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <b>PR</b> = Precipitation Rate</p>
          <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <b>96.25</b> = The constant that converts gallons per minute(GPM)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to inches per hour.</p>
          <p>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <b>GPM</b> = the number of sprinklerheads x the application rate
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            (gal/min).</p>
          <p>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <b>A</b> = the area of your hydrozone</p>
          <p><b>Now</b>, enter the value you&rsquo;ve calculated into the Precipitation Rate space in the Calculator tool.</p>
          <p>&nbsp;</p>
          </p>
        </div>
      </div>
    </div>
  </div>
  <script>
    // showing the disclaimer window.
    $(window).ready(function() {
      $('.loader').fadeOut("slow");

      $("#nextTimeSwitcher input").on("click", function() {
        if ($("#nextTimeSwitcher input:checked").val() === "on") {
          localStorage.setItem('popState', 'shown');
        } else {

          localStorage.setItem('popState', 'notShown');
        }
      })

      if (localStorage.getItem('popState') != 'shown') {
        console.log("show disclaimer");
        $('#disclaimer').modal('show');

      } else {
        console.log("hide disclaimer");
        $('#disclaimer').modal('hide');
      }
      $('#disclaimer-close').click(function(e) // You are clicking the close button
        {
          $('#disclaimer').fadeOut(); // Now the pop up is hiden.
          $('#disclaimer').modal('hide');
        });
    });

    $(".showFrontPage").on("click", function() {
      $('#disclaimer').modal('show');
      localStorage.setItem('popState', 'notShown');
    })


    var mymap = L.map('map', {
      zoomControl: false,
      maxZoom: 16,
      minZoom: 1
    }).fitBounds([
      [56.73, -135.48],
      [18.97, -67.35]
    ]);

    $(".leaflet-control-attribution")
      .css("background-color", "transparent")
      .html("Supported by <a href='http://geoviz.ceoas.oregonstate.edu' target='_blank'> GeoViz Lab @ Oregon State University </a>")
      .html("");


    var gray = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}@2x.png').addTo(mymap);
    var streets = L.tileLayer('http://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}@2x.png');
    var satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');

    var baseLayers = {
      'Grayscale': gray,
      'Streets': streets,
      'Satellite': satellite
    }

    var placename, soil, guage, turfZones, et, marker, s, tz, chart;
    var maintenanceType = "Adequate";
    var soiltype = ["(Not Applicable)", "for Fine Soil", "for Mucky Soil", "for Coarse Soil"];
    var cSoilType = soiltype[0];
    // et: evapotranspiration

    var cd = new Date();
    var month = cd.getMonth();
    et = L.leafletGeotiff(url = "assets/pet/M" + (month + 1).toString() + ".tif",
      options = {
        band: 0,
        displayMin: 4,
        displayMax: 22,
        name: 'Evapotranspiration',
        colorScale: 'viridis',
        clampLow: false,
        clampHigh: true,
        // vector:true,
        arrowSize: 20
      }
    ).addTo(mymap);

    $("#rainVolume").val(month + 1);

    $("#rainVolume").change(function() {

      mymap.removeLayer(et);
      var month = $("#rainVolume").val();
      if (month.length == 1) {
        month = "0" + month;
      };
      et = L.leafletGeotiff(url = "assets/pet/M" + month + ".tif",
        options = {
          band: 0,
          displayMin: 4,
          displayMax: 22,
          name: 'Evapotranspiration',
          colorScale: 'viridis',
          clampLow: false,
          clampHigh: true,
          // vector:true,
          arrowSize: 20
        }
      ).addTo(mymap);
    })



    $("#rainVolume").on("change ready", function() {

      mymap.removeLayer(et);
      var month = $("#rainVolume").val();
      if (month.length == 1) {
        month = "0" + month;
      };
      et = L.leafletGeotiff(url = "assets/pet/M" + month + ".tif",
        options = {
          band: 0,
          displayMin: 4,
          displayMax: 22,
          name: 'Evapotranspiration',
          colorScale: 'viridis',
          clampLow: false,
          clampHigh: true,
          // vector:true,
          arrowSize: 20
        }
      ).addTo(mymap);
    })


    placename = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}@2x.png').addTo(mymap);



    //will permanently change the style
    $(".btn").on("click", function() {
      $(".btn").css("background-color", "#343a40");
      $(this).css("background-color", "#777");
      maintenanceType = $(this).text().trim();
      console.log(maintenanceType);
    });

    Promise.all([
      d3.json("assets/soil.json"),
      d3.json("assets/rainStates.geojson"),
      d3.json("assets/turfZones.geojson"),
    ]).then(function(datasets) {

      function soilStyle(feature) {
        var c = "red";
        var t = 0;
        switch (+feature.properties.class) {
          case 1:
            c = "green";
            t = 0.4;
            break;
          case 2:
            c = "lightgreen";
            t = 0.4;
            break;
          case 3:
            c = "yellow";
            t = 0.4;
            break;
          default:
            c = "red";
            t = 0;
        }

        return {
          fillColor: c,
          fillOpacity: t,
          weight: 0.1,
          opacity: 0,
          smoothFactor: 0
        };
      };

      function turfStyle(feature) {
        var c = "red";
        switch (+feature.properties.Id) {
          case 0:
            c = "blue";
            break;
          case 1:
            c = "red";
            break;
          default:
            c = "red";
        }
        return {
          fillColor: c,
          fillOpacity: 0.2,
          weight: 0.1,
          opacity: 0,
          smoothFactor: 0
        };
      };


      function onEachFeature(feature, layer) {
        layer.on({
          click: clickFeature
        });
      };

      function clickFeature(e) {

        if (!marker) {
          marker = L.marker([e.latlng.lat, e.latlng.lng]).addTo(mymap);
        } else {
          marker.setLatLng([e.latlng.lat, e.latlng.lng]);
        }


        s = +this.feature.properties.class;

        cSoilType = soiltype[s];
        $("#soiltype").text(cSoilType);


        var turfZoneFeature = leafletPip.pointInLayer(e.latlng, turfZones)[0];
        var cZone = turfZoneFeature.feature.properties.zoneID;
        var monthName = $("#rainVolume option:selected").text();
        var rainStateFeature = leafletPip.pointInLayer(e.latlng, rainStates)[0];
        var cRainState = rainStateFeature.feature.properties[monthName];
        ev = et.getValueAtLatLng(e.latlng.lat, e.latlng.lng).toFixed(2);

        //xu's editing
        var monthNum = $("#rainVolume option:selected").val();
        var pr = $("input").val();
        var runTime = $("#run").val();
        var cpf = $("#spf").val();


        //do the switch here for cZone
        switch (cZone) {
          case 'Warm':
            cZone = 1;
            break;
          case 'Cold':
            cZone = 2;
            break;
        }

        //cZone need to be changed into numbers , 1 for cold，2 for warm
        console.log(cZone);
        console.log(cRainState);
        console.log(cSoilType);
        console.log(ev);

        //do the switch here for soiltype
        switch (maintenanceType) {
          case 'Professional':
            maintenanceType = 1.0;
            break;
          case 'Premium':
            maintenanceType = 0.8;
            break;
          case 'Homeowner':
            maintenanceType = 0.6;
            break;
          case 'Adequate':
            maintenanceType = 0.5;
            break;
          case 'Survival':
            maintenanceType = 0.4;
            break;
        }

        console.log(pr);
        console.log(runTime);
        console.log(cpf);
        console.log(maintenanceType);

        //testValue = (s * ev * 5).toFixed(0);

        //scroll to the bottom
        var h = $(".simplebar-content-wrapper").height();
        $(".simplebar-content-wrapper").scrollTop(h);

        //testValue = ((pr * 60 / runTime) * ((ev * cropcoefficient * cpf * 1.0 * maintenacefactor for soil)) - (0.7 * cRainState)).toFixed(0);
        testValue = ((pr * 60 / runTime) * ((ev * cZone * cpf * 1.0 * maintenanceType)) - (0.7 * cRainState)).toFixed(0);
        console.log(testValue);
        $("#test").html(testValue);

        chart.load({
          columns: [
            ['data', testValue]
          ]
        });
      };


      soil = new L.TopoJSON(datasets[0], {
        style: soilStyle,
        onEachFeature: onEachFeature
      }).addTo(mymap);

      rainStates = L.geoJSON(datasets[1], {
        style: {
          opacity: 0.8,
          fillOpacity: 0,
          weight: 2,
          color: "brown",
          dashArray: '6',
        }
      }).addTo(mymap);

      turfZones = new L.geoJSON(datasets[2], {
        style: turfStyle
      }).addTo(mymap);

      var overlays = {
        "<span><b>Place Names</b></span>": placename,
        "<span><b>Soil Class</b></span>": soil,
        // "<span><b>Plant Hardness</b></span>": hardGroup,
        "<span><b>Turf Zones</b></span>": turfZones,
        "<span><b>Precipitation</b></span>": rainStates
        // "<span><b>Evapotranspiration</b></span>": et,
      };

      L.control.layers(baseLayers, overlays, {
        collapsed: false
      }).addTo(mymap);

      soil.bringToFront();
      placename.bringToFront();

      chart = c3.generate({
        data: {
          columns: [
            ['data', 0]
          ],
          type: 'gauge',
          // onclick: function(d, i) {
          //   console.log("onclick", d, i);
          // },
          // onmouseover: function(d, i) {
          //   console.log("onmouseover", d, i);
          // },
          // onmouseout: function(d, i) {
          //   console.log("onmouseout", d, i);
          // }
        },
        legend: {
          show: false
        },
        gauge: {
          label: {
            format: function(value, ratio) {
              return value;
            },
            show: true // to turn off the min/max labels.
          },
          width: 39, // for adjusting arc thickness
          max: 240
        },
        color: {
          //  pattern: ['#6baed6', '#4292c6', '#2171b5', '#08519c'], // the three color levels for the percentage values.
          pattern: ['#FF0000', '#F97600', '#F6C600', '#60B044'],
          threshold: {
            unit: 'value',
            max: 240,
            values: [0, 120, 180, 240]
          }
        },
        tooltip: {
          show: false
        },
        size: {
          height: 180
        },
        bindto: "#waterGauge"
      });

    });



    var geocoder = L.Control.geocoder({
        defaultMarkGeocode: false,
        showUniqueResult: true,
        placeholder: "Search a location...",
        errorMessage: "Nothing was Found..."
      })
      .on('markgeocode', function(e) {

        lat = e.geocode.center.lat;
        lng = e.geocode.center.lng;

        if (!marker) {
          marker = L.marker([lat, lng]).addTo(mymap);
        } else {
          marker.setLatLng([lat, lng]);
        }


        var soilFeature = leafletPip.pointInLayer(e.geocode.center, soil)[0];
        s = soilFeature.feature.properties.class;

        cSoilType = soiltype[s];
        $("#soiltype").text(cSoilType);

        var turfZoneFeature = leafletPip.pointInLayer(e.geocode.center, turfZones)[0];
        var cZone = turfZoneFeature.feature.properties.zoneID;
        var monthName = $("#rainVolume option:selected").text();
        var rainStateFeature = leafletPip.pointInLayer(e.geocode.center, rainStates)[0];
        var cRainState = rainStateFeature.feature.properties[monthName];
        ev = et.getValueAtLatLng(e.geocode.center.lat, e.geocode.center.lng).toFixed(2);

        //xu's editing
        var monthNum = $("#rainVolume option:selected").val();
        var pr = $("input").val();
        var runTime = $("#run").val();
        var cpf = $("#spf").val();

        switch (cZone) {
          case 'Warm':
            cZone = 1;
            break;
          case 'Cold':
            cZone = 2;
            break;
        }

        console.log(cZone);
        console.log(cRainState);
        console.log(cSoilType);
        console.log(ev);

        //do the switch here for soiltype
        switch (maintenanceType) {
          case 'Professional':
            maintenanceType = 1.0;
            break;
          case 'Premium':
            maintenanceType = 0.8;
            break;
          case 'Homeowner':
            maintenanceType = 0.6;
            break;
          case 'Adequate':
            maintenanceType = 0.5;
            break;
          case 'Survival':
            maintenanceType = 0.4;
            break;
        }

        console.log(pr);
        console.log(runTime);
        console.log(cpf);
        console.log(maintenanceType);

        //testValue = (s * ev * 5).toFixed(0);

        //scroll to the bottom
        var h = $(".simplebar-content-wrapper").height();
        $(".simplebar-content-wrapper").scrollTop(h);

        //testValue = ((pr * 60 / runTime) * ((ev * cropcoefficient * cpf * 1.0 * maintenacefactor for soil)) - (0.7 * cRainState)).toFixed(0);
        testValue = ((pr * 60 / runTime) * ((ev * cZone * cpf * 1.0 * maintenanceType)) - (0.7 * cRainState)).toFixed(0);
        console.log(testValue);
        $("#test").html(testValue);


        chart.load({
          columns: [
            ['data', testValue] //value of here need to be calculated right
          ]
        });

        // mymap.fitBounds([
        //   [56.73, -135.48],
        //   [18.97, -67.35]
        // ]);

      })
      .addTo(mymap);



    $('.btn').on('click', function(e) {

      chart.load({
        columns: [
          ['data', 0] //value of here need to be calculated right
        ]
      });

    });


    $('#waterhr, #run, #spf, #rainVolume').on('change', function(e) {

      chart.load({
        columns: [
          ['data', 0] //value of here need to be calculated right
        ]
      });

    });


    // $('input, select').on('change', function(e){
    //
    //   lat = 47.674;
    //   lng = -122.344;
    //
    //   if (!marker) {
    //     marker = L.marker([lat, lng]).addTo(mymap);
    //   } else {
    //     marker.setLatLng([lat, lng]);
    //   }
    //
    //
    //   var cMarker = {lat: lat, lng: lng}
    //
    //   var soilFeature = leafletPip.pointInLayer(cMarker, soil)[0];
    //   s = soilFeature.feature.properties.class;
    //
    //   cSoilType = soiltype[s];
    //   $("#soiltype").text(cSoilType);
    //
    //   var turfZoneFeature = leafletPip.pointInLayer(cMarker, turfZones)[0];
    //   var cZone = turfZoneFeature.feature.properties.zoneID;
    //   var monthName = $("#rainVolume option:selected").text();
    //   var rainStateFeature = leafletPip.pointInLayer(cMarker, rainStates)[0];
    //   var cRainState = rainStateFeature.feature.properties[monthName];
    //   ev = et.getValueAtLatLng(lat, lng).toFixed(2);
    //
    //   //xu's editing
    //   var monthNum = $("#rainVolume option:selected").val();
    //   var pr = $("input").val();
    //   var runTime = $("#run").val();
    //   var cpf = $("#spf").val();
    //
    //   switch(cZone){
    //     case 'Warm':
    //       cZone = 1;
    //       break;
    //     case 'Cold':
    //       cZone = 2;
    //       break;
    //   }
    //
    //   console.log(cZone);
    //   console.log(cRainState);
    //   console.log(cSoilType);
    //   console.log(ev);
    //
    //   //do the switch here for soiltype
    //   switch(maintenanceType){
    //     case'Professional':
    //       maintenanceType = 1.0;
    //       break;
    //     case 'Premium':
    //       maintenanceType =  0.8;
    //       break;
    //     case 'Homeowner':
    //       maintenanceType = 0.6;
    //       break;
    //     case 'Adequate':
    //       maintenanceType = 0.5;
    //       break;
    //     case 'Survival':
    //       maintenanceType = 0.4;
    //       break;
    //   }
    //
    //   console.log(pr);
    //   console.log(runTime);
    //   console.log(cpf);
    //   console.log(maintenanceType);
    //
    //   //testValue = (s * ev * 5).toFixed(0);
    //
    //   //scroll to the bottom
    //   var h = $(".simplebar-content-wrapper").height();
    //   $(".simplebar-content-wrapper").scrollTop(h);
    //
    //   //testValue = ((pr * 60 / runTime) * ((ev * cropcoefficient * cpf * 1.0 * maintenacefactor for soil)) - (0.7 * cRainState)).toFixed(0);
    //   testValue = ((pr * 60 / runTime) * ((ev * cZone * cpf * 1.0 * maintenanceType)) - (0.7 * cRainState)).toFixed(0);
    //   console.log(testValue);
    //   $("#test").html(testValue);
    //
    //
    //   chart.load({
    //     columns: [
    //       ['data', testValue]  //value of here need to be calculated right
    //     ]
    //   });
    //
    // });
  </script>
</body>

</html>
